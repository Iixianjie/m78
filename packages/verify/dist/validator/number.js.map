{"version":3,"sources":["/Users/lixianjie/project/openSource/m78/packages/verify/src/validator/number.ts"],"sourcesContent":["import { isInt, isNumber, isWeakNumber } from \"@m78/utils\";\nimport { Meta, Validator } from \"../types\";\n\ninterface Opt {\n  max?: number;\n  min?: number;\n  size?: number;\n  /** 只能是整形 */\n  integer?: boolean;\n  /** 允许字符数字 */\n  allowNumberString?: boolean;\n}\n\nexport const numberValidatorKey = \"verifyNumber\";\n\n/**\n * 数字验证器\n * */\nexport const number = (option?: Opt) => {\n  const numberValidator: Validator = ({ value, config }: Meta) => {\n    const pack = config.languagePack.number;\n\n    const checker = option?.allowNumberString ? isWeakNumber : isNumber;\n\n    if (!checker(value))\n      return {\n        errorTemplate: pack.notExpected,\n        interpolateValues: option || {},\n      };\n\n    if (!option) return;\n\n    // 确保后续操作为数值\n    const numValue = parseFloat(value);\n\n    if (option.integer && !isInt(numValue))\n      return {\n        errorTemplate: pack.notInteger,\n        interpolateValues: option!,\n      };\n\n    if (isNumber(option.size) && numValue !== option.size)\n      return {\n        errorTemplate: pack.size,\n        interpolateValues: option!,\n      };\n\n    if (isNumber(option.max) && numValue > option.max)\n      return {\n        errorTemplate: pack.max,\n        interpolateValues: option!,\n      };\n\n    if (isNumber(option.min) && numValue < option.min)\n      return {\n        errorTemplate: pack.min,\n        interpolateValues: option!,\n      };\n  };\n\n  numberValidator.key = numberValidatorKey;\n\n  return numberValidator;\n};\n"],"names":["isInt","isNumber","isWeakNumber","numberValidatorKey","number","option","numberValidator","value","config","pack","languagePack","checker","allowNumberString","errorTemplate","notExpected","interpolateValues","numValue","parseFloat","integer","notInteger","size","max","min","key"],"mappings":"AAAA,SAASA,KAAK,EAAEC,QAAQ,EAAEC,YAAY,QAAQ,YAAY,CAAC;AAa3D,OAAO,IAAMC,kBAAkB,GAAG,cAAc,CAAC;AAEjD;;GAEG,GACH,OAAO,IAAMC,MAAM,GAAG,SAACC,MAAY,EAAK;IACtC,IAAMC,eAAe,GAAc,gBAA6B;YAA1BC,KAAK,SAALA,KAAK,EAAEC,MAAM,SAANA,MAAM;QACjD,IAAMC,IAAI,GAAGD,MAAM,CAACE,YAAY,CAACN,MAAM,AAAC;QAExC,IAAMO,OAAO,GAAGN,CAAAA,MAAM,aAANA,MAAM,WAAmB,GAAzBA,KAAAA,CAAyB,GAAzBA,MAAM,CAAEO,iBAAiB,CAAA,GAAGV,YAAY,GAAGD,QAAQ,AAAC;QAEpE,IAAI,CAACU,OAAO,CAACJ,KAAK,CAAC,EACjB,OAAO;YACLM,aAAa,EAAEJ,IAAI,CAACK,WAAW;YAC/BC,iBAAiB,EAAEV,MAAM,IAAI,EAAE;SAChC,CAAC;QAEJ,IAAI,CAACA,MAAM,EAAE,OAAO;QAEpB,YAAY;QACZ,IAAMW,QAAQ,GAAGC,UAAU,CAACV,KAAK,CAAC,AAAC;QAEnC,IAAIF,MAAM,CAACa,OAAO,IAAI,CAAClB,KAAK,CAACgB,QAAQ,CAAC,EACpC,OAAO;YACLH,aAAa,EAAEJ,IAAI,CAACU,UAAU;YAC9BJ,iBAAiB,EAAEV,MAAM;SAC1B,CAAC;QAEJ,IAAIJ,QAAQ,CAACI,MAAM,CAACe,IAAI,CAAC,IAAIJ,QAAQ,KAAKX,MAAM,CAACe,IAAI,EACnD,OAAO;YACLP,aAAa,EAAEJ,IAAI,CAACW,IAAI;YACxBL,iBAAiB,EAAEV,MAAM;SAC1B,CAAC;QAEJ,IAAIJ,QAAQ,CAACI,MAAM,CAACgB,GAAG,CAAC,IAAIL,QAAQ,GAAGX,MAAM,CAACgB,GAAG,EAC/C,OAAO;YACLR,aAAa,EAAEJ,IAAI,CAACY,GAAG;YACvBN,iBAAiB,EAAEV,MAAM;SAC1B,CAAC;QAEJ,IAAIJ,QAAQ,CAACI,MAAM,CAACiB,GAAG,CAAC,IAAIN,QAAQ,GAAGX,MAAM,CAACiB,GAAG,EAC/C,OAAO;YACLT,aAAa,EAAEJ,IAAI,CAACa,GAAG;YACvBP,iBAAiB,EAAEV,MAAM;SAC1B,CAAC;IACN,CAAC,AAAC;IAEFC,eAAe,CAACiB,GAAG,GAAGpB,kBAAkB,CAAC;IAEzC,OAAOG,eAAe,CAAC;AACzB,CAAC,CAAC"}