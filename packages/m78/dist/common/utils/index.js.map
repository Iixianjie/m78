{"version":3,"sources":["/Users/lixianjie/project/openSource/m78/packages/m78/src/common/utils/index.ts"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSelf } from \"@m78/hooks\";\n\n/** 禁止冒泡的便捷扩展对象 */\nexport const stopPropagation = {\n  onClick(e: React.SyntheticEvent) {\n    e.stopPropagation();\n  },\n};\n\n/** throw error */\nexport function throwError(errorMsg: string, namespace?: string): never {\n  throw new Error(\n    `M78💥 -> ${namespace ? `${namespace} -> ` : \"\"} ${errorMsg}`\n  );\n}\n\nexport function sendWarning(msg: string, namespace?: string) {\n  console.log(`M78💢 -> ${namespace ? `${namespace} -> ` : \"\"} ${msg}`);\n}\n\nexport function useDelayToggle(\n  toggle: boolean,\n  options?: {\n    /** 300 | 开启延迟，默认为delay的值, 设置为0禁用 */\n    leading?: number;\n    /** 600 | 离场延迟，默认为delay的值, 设置为0禁用 */\n    trailing?: number;\n  }\n): boolean {\n  const { leading = 300, trailing = 600 } = options || {};\n\n  const isDisabled = !trailing && !leading;\n\n  // 初始值在禁用或未开启前导延迟时为toggle本身，否则为false\n  const [innerState, setInnerState] = useState(!leading ? toggle : false);\n\n  const self = useSelf({\n    toggleTimer: null as any,\n  });\n\n  useEffect(() => {\n    if (isDisabled) return;\n\n    if ((toggle && !leading) || (!toggle && !trailing)) {\n      toggle !== innerState && setInnerState(toggle);\n      return;\n    }\n\n    const d = toggle ? leading : trailing;\n\n    self.toggleTimer = setTimeout(() => {\n      setInnerState(toggle);\n    }, d);\n\n    return () => {\n      self.toggleTimer && clearTimeout(self.toggleTimer);\n    };\n  }, [toggle]);\n\n  return isDisabled ? toggle : innerState;\n}\n"],"names":["React","useState","useEffect","useSelf","stopPropagation","onClick","e","throwError","errorMsg","namespace","Error","sendWarning","msg","console","log","useDelayToggle","toggle","options","leading","trailing","isDisabled","innerState","setInnerState","self","toggleTimer","d","setTimeout","clearTimeout"],"mappings":"AAAA;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO,CAAC;AACnD,SAASC,OAAO,QAAQ,YAAY,CAAC;AAErC,gBAAgB,GAChB,OAAO,IAAMC,eAAe,GAAG;IAC7BC,OAAO,EAAPA,SAAQC,CAAuB,EAAE;QAC/BA,CAAC,CAACF,eAAe,EAAE,CAAC;IACtB,CAAC;CACF,CAAC;AAEF,gBAAgB,GAChB,OAAO,SAASG,UAAU,CAACC,QAAgB,EAAEC,SAAkB,EAAS;IACtE,MAAM,IAAIC,KAAK,CACb,AAAC,qBAAQ,CAAyCF,MAAQ,CAA/CC,SAAS,GAAG,AAAC,EAAA,CAAY,MAAI,CAAdA,SAAS,EAAC,MAAI,CAAC,GAAG,EAAE,EAAC,GAAC,CAAW,CAAA,MAAA,CAATD,QAAQ,CAAE,CAC7D,CAAC;AACJ,CAAC;AAED,OAAO,SAASG,WAAW,CAACC,GAAW,EAAEH,SAAkB,EAAE;IAC3DI,OAAO,CAACC,GAAG,CAAC,AAAC,qBAAQ,CAAyCF,MAAG,CAA1CH,SAAS,GAAG,AAAC,EAAA,CAAY,MAAI,CAAdA,SAAS,EAAC,MAAI,CAAC,GAAG,EAAE,EAAC,GAAC,CAAM,CAAA,MAAA,CAAJG,GAAG,CAAE,CAAC,CAAC;AACvE,CAAC;AAED,OAAO,SAASG,cAAc,CAC5BC,MAAe,EACfC,OAKC,EACQ;IACT,IAA0CA,GAAa,GAAbA,OAAO,IAAI,EAAE,aAAbA,GAAa,CAA/CC,OAAO,EAAPA,OAAO,yBAAG,GAAG,WAAA,cAAqBD,GAAa,CAAhCE,QAAQ,EAARA,QAAQ,0BAAG,GAAG,YAAA,AAAmB;IAExD,IAAMC,UAAU,GAAG,CAACD,QAAQ,IAAI,CAACD,OAAO,AAAC;IAEzC,oCAAoC;IACpC,IAAoCjB,IAAmC,oBAAnCA,QAAQ,CAAC,CAACiB,OAAO,GAAGF,MAAM,GAAG,KAAK,CAAC,IAAA,EAAhEK,UAAU,GAAmBpB,IAAmC,GAAtD,EAAEqB,aAAa,GAAIrB,IAAmC,GAAvC,AAAwC;IAExE,IAAMsB,IAAI,GAAGpB,OAAO,CAAC;QACnBqB,WAAW,EAAE,IAAI;KAClB,CAAC,AAAC;IAEHtB,SAAS,CAAC,WAAM;QACd,IAAIkB,UAAU,EAAE,OAAO;QAEvB,IAAI,AAACJ,MAAM,IAAI,CAACE,OAAO,IAAM,CAACF,MAAM,IAAI,CAACG,QAAQ,AAAC,EAAE;YAClDH,MAAM,KAAKK,UAAU,IAAIC,aAAa,CAACN,MAAM,CAAC,CAAC;YAC/C,OAAO;QACT,CAAC;QAED,IAAMS,CAAC,GAAGT,MAAM,GAAGE,OAAO,GAAGC,QAAQ,AAAC;QAEtCI,IAAI,CAACC,WAAW,GAAGE,UAAU,CAAC,WAAM;YAClCJ,aAAa,CAACN,MAAM,CAAC,CAAC;QACxB,CAAC,EAAES,CAAC,CAAC,CAAC;QAEN,OAAO,WAAM;YACXF,IAAI,CAACC,WAAW,IAAIG,YAAY,CAACJ,IAAI,CAACC,WAAW,CAAC,CAAC;QACrD,CAAC,CAAC;IACJ,CAAC,EAAE;QAACR,MAAM;KAAC,CAAC,CAAC;IAEb,OAAOI,UAAU,GAAGJ,MAAM,GAAGK,UAAU,CAAC;AAC1C,CAAC"}