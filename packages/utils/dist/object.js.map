{"version":3,"sources":["/Users/lixianjie/project/openSource/m78/packages/utils/src/object.ts"],"sourcesContent":["import { isString, isArray, isNumber, isWeakNumber, isObject } from \"./is.js\";\n\n/**\n * Delete all falsy values of the object (except 0)\n * @param source - Target object\n * @return - Processed original object\n */\nexport const shakeFalsy = (source: object): object => {\n  Object.keys(source).forEach((key) => {\n    const val = source[key];\n    if (!val && val !== 0) {\n      delete source[key];\n    }\n  });\n  return source;\n};\n\nfunction pickOrOmit(obj: any, props: string | string[], isPick = false) {\n  if (isString(props)) {\n    props = props.split(\",\").map((key) => key.trim());\n  }\n  const keys = Object.keys(obj);\n  const result = {};\n  keys.forEach((item) => {\n    const cond = isPick\n      ? props.indexOf(item) !== -1\n      : props.indexOf(item) === -1;\n    if (cond) {\n      result[item] = obj[item];\n    }\n  });\n  return result;\n}\n\n/**\n * Deletes the specified key value from the target object\n * @param obj - Target object\n * @param props - Key to be removed, comma separated string or string array\n * @return - New object after removal\n * */\nexport function omit<R>(obj: any, props: string | string[]): R {\n  return pickOrOmit(obj, props) as R;\n}\n\n/**\n * Pick the specified key value from the target object\n * @param obj - Target object\n * @param props - Key to be selected, comma separated string or string array\n * @return - A new object containing the selection key value\n * */\nexport function pick<R>(obj: any, props: string | string[]): R {\n  return pickOrOmit(obj, props, true) as R;\n}\n\n/**\n * Represents the character or character array of name. The array usage is used for chain value, such as: ['user', 'address']、['1', 'name']、['list', '4', 'name']\n *\n * 表示name的字符或字符数组，数组用法用于链式取值，如: ['user', 'address']、['1', 'name']、['list', '4', 'name']\n * */\nexport type NamePath = string | string[];\n\n/**\n * Get value on obj through NamePath\n *\n * 通过NamePath在obj上获取值\n * */\nexport function getNamePathValue(obj: any, name: NamePath) {\n  if (isString(name)) {\n    return obj?.[name];\n  }\n\n  if (isArray(name) && name.length) {\n    return name.reduce((p, i) => {\n      return p?.[i];\n    }, obj);\n  }\n}\n\n/**\n * Convert NamePath to character form\n *\n * 将NamePath转换为字符形式\n * */\nexport function stringifyNamePath(name: NamePath) {\n  if (isString(name)) return name;\n\n  return name.reduce((p, i) => {\n    if (isNumber(Number(i))) {\n      return `${p}[${i}]`;\n    }\n\n    if (isString(i)) {\n      return p.length ? `${p}.${i}` : i;\n    }\n\n    return p;\n  }, \"\");\n}\n\n/**\n * Set value on obj through NamePath\n *\n * 通过NamePath在obj上设置值\n * */\nexport function setNamePathValue(obj: any, name: NamePath, val: any) {\n  if (isString(name)) {\n    obj[name] = val;\n  }\n\n  if (isArray(name) && name.length) {\n    let lastObj = obj;\n\n    for (let i = 0; i < name.length; i++) {\n      const n = name[i]; // 当前name\n      const nextN = name[i + 1]; // 下一个name\n      const hasNextN = nextN !== undefined; // 是否有下个\n\n      if (!hasNextN) {\n        lastObj[n] = val;\n        return;\n      }\n\n      // 确保要操作的对象存在\n      if (isWeakNumber(nextN)) {\n        if (!isArray(lastObj[n])) {\n          lastObj[n] = [];\n        }\n        // 不是数字的话则为对象\n      } else if (!isObject(lastObj[n])) {\n        lastObj[n] = {};\n      }\n\n      lastObj = lastObj[n];\n    }\n  }\n}\n"],"names":["isString","isArray","isNumber","isWeakNumber","isObject","shakeFalsy","source","Object","keys","forEach","key","val","pickOrOmit","obj","props","isPick","split","map","trim","result","item","cond","indexOf","omit","pick","getNamePathValue","name","length","reduce","p","i","stringifyNamePath","Number","setNamePathValue","lastObj","n","nextN","hasNextN","undefined"],"mappings":"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"}