{"version":3,"sources":["/Users/lixianjie/project/openSource/m78/packages/hooks/src/state/use-select/use-select.ts"],"sourcesContent":["import {\n  SelectManager,\n  SelectManagerOption,\n  SelectManagerValue,\n} from \"./select-manager\";\nimport { useEffect, useMemo } from \"react\";\nimport { useUpdate } from \"../../effect/use-update/use-update\";\nimport { useUpdateEffect } from \"../../effect/use-update-effect/use-update-effect\";\n\n/**\n * 用于列表的选中项管理, 内置了对于超大数据量的优化(用于m78组件的tree等组件高性能管理选中/展开等)\n * - 具体api见SelectManager\n * - 注意, 由于会实时读取list并更新选中状态, option.list不能传入字面量, 否则会导致递归渲染\n * */\nexport function useSelect<Item = SelectManagerValue>(\n  option: SelectManagerOption<Item>\n) {\n  const select = useMemo(() => new SelectManager<Item>(option), []);\n\n  const update = useUpdate();\n\n  useEffect(() => {\n    select.changeEvent.on(update);\n\n    return () => select.changeEvent.off(update);\n  }, []);\n\n  useUpdateEffect(() => {\n    select.setList(option.list);\n  }, [option.list]);\n\n  return select;\n}\n"],"names":["SelectManager","useEffect","useMemo","useUpdate","useUpdateEffect","useSelect","option","select","update","changeEvent","on","off","setList","list"],"mappings":"AAAA,SACEA,aAAa,QAGR,kBAAkB,CAAC;AAC1B,SAASC,SAAS,EAAEC,OAAO,QAAQ,OAAO,CAAC;AAC3C,SAASC,SAAS,QAAQ,oCAAoC,CAAC;AAC/D,SAASC,eAAe,QAAQ,kDAAkD,CAAC;AAEnF;;;;GAIG,GACH,OAAO,SAASC,SAAS,CACvBC,MAAiC,EACjC;IACA,IAAMC,MAAM,GAAGL,OAAO,CAAC;eAAM,IAAIF,aAAa,CAAOM,MAAM,CAAC;KAAA,EAAE,EAAE,CAAC,AAAC;IAElE,IAAME,MAAM,GAAGL,SAAS,EAAE,AAAC;IAE3BF,SAAS,CAAC,WAAM;QACdM,MAAM,CAACE,WAAW,CAACC,EAAE,CAACF,MAAM,CAAC,CAAC;QAE9B,OAAO;mBAAMD,MAAM,CAACE,WAAW,CAACE,GAAG,CAACH,MAAM,CAAC;SAAA,CAAC;IAC9C,CAAC,EAAE,EAAE,CAAC,CAAC;IAEPJ,eAAe,CAAC,WAAM;QACpBG,MAAM,CAACK,OAAO,CAACN,MAAM,CAACO,IAAI,CAAC,CAAC;IAC9B,CAAC,EAAE;QAACP,MAAM,CAACO,IAAI;KAAC,CAAC,CAAC;IAElB,OAAON,MAAM,CAAC;AAChB,CAAC"}