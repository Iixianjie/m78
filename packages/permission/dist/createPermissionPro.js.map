{"version":3,"sources":["/Users/lixianjie/project/openSource/m78/packages/permission/src/createPermissionPro.ts"],"sourcesContent":["import create from '@m78/seed';\nimport {\n  _PermissionProSeedState,\n  create as createPermission,\n  PermissionProRejectMeta,\n} from './index';\nimport { PermissionPro, PermissionProCreator } from './proType';\nimport { PERMISSION_PRO_NAME, permissionProValidatorGetter } from './common';\n\nconst _createPermissionPro: PermissionProCreator = config => {\n  const _config = {\n    permission: {},\n    ...config,\n  };\n\n  let { seed } = _config;\n\n  if (!seed) seed = create();\n\n  seed.set({\n    permission: _config.permission!,\n    meta: _config.meta,\n  });\n\n  const permission = createPermission<_PermissionProSeedState>({\n    seed,\n    validators: {\n      [PERMISSION_PRO_NAME]: permissionProValidatorGetter(),\n    },\n  });\n\n  const pro: PermissionPro = {\n    check: keys => {\n      const vm = permission([PERMISSION_PRO_NAME], {\n        extra: keys,\n      });\n      return vm?.length ? ((vm[0] as any) as PermissionProRejectMeta) : null;\n    },\n    seed,\n    permission,\n  };\n\n  return pro;\n};\n\nexport { _createPermissionPro };\n"],"names":["create","createPermission","PERMISSION_PRO_NAME","permissionProValidatorGetter","_createPermissionPro","config","_config","permission","seed","set","meta","validators","pro","check","keys","vm","extra","length"],"mappings":"AAAA;;AAAA,OAAOA,MAAM,MAAM,WAAW,CAAC;AAC/B,SAEEA,MAAM,IAAIC,gBAAgB,QAErB,SAAS,CAAC;AAEjB,SAASC,mBAAmB,EAAEC,4BAA4B,QAAQ,UAAU,CAAC;AAE7E,IAAMC,oBAAoB,GAAyBC,SAAAA,MAAM,EAAI;IAC3D,IAAMC,OAAO,GAAG;QACdC,UAAU,EAAE,EAAE;OACXF,MAAM,CACV,AAAC;IAEF,IAAI,AAAEG,IAAI,GAAKF,OAAO,CAAhBE,IAAI,AAAY,AAAC;IAEvB,IAAI,CAACA,IAAI,EAAEA,IAAI,GAAGR,MAAM,EAAE,CAAC;IAE3BQ,IAAI,CAACC,GAAG,CAAC;QACPF,UAAU,EAAED,OAAO,CAACC,UAAU;QAC9BG,IAAI,EAAEJ,OAAO,CAACI,IAAI;KACnB,CAAC,CAAC;IAEH,IAAMH,UAAU,GAAGN,gBAAgB,CAA0B;QAC3DO,IAAI,EAAJA,IAAI;QACJG,UAAU,EACR,qBAACT,mBAAmB,EAAGC,4BAA4B,EAAE,CAAA;KAExD,CAAC,AAAC;IAEH,IAAMS,GAAG,GAAkB;QACzBC,KAAK,EAAEC,SAAAA,IAAI,EAAI;YACb,IAAMC,EAAE,GAAGR,UAAU,CAAC;gBAACL,mBAAmB;aAAC,EAAE;gBAC3Cc,KAAK,EAAEF,IAAI;aACZ,CAAC,AAAC;YACH,OAAOC,CAAAA,EAAE,aAAFA,EAAE,WAAQ,GAAVA,KAAAA,CAAU,GAAVA,EAAE,CAAEE,MAAM,CAAA,GAAKF,EAAE,CAAC,CAAC,CAAC,GAAuC,IAAI,CAAC;QACzE,CAAC;QACDP,IAAI,EAAJA,IAAI;QACJD,UAAU,EAAVA,UAAU;KACX,AAAC;IAEF,OAAOK,GAAG,CAAC;AACb,CAAC,AAAC;AAEF,SAASR,oBAAoB,GAAG"}