{"version":3,"sources":["/Users/lixianjie/project/openSource/m78/packages/request/src/adapter/axios.ts"],"sourcesContent":["import { BaseRequestOptions, Options } from \"../interfaces\";\nimport { Response } from \"../response\";\nimport { ResponseError } from \"../response-error\";\n\nimport axios, { AxiosRequestConfig } from \"axios\";\nimport { omit } from \"@m78/utils\";\n\nexport interface AxiosOptions<Ext = {}>\n  extends Omit<AxiosRequestConfig, \"url\" | \"data\" | \"headers\">,\n    BaseRequestOptions<Options<AxiosOptions<Ext>> & Ext> {}\n\nconst responseProcess = (res: any) => {\n  const response = new Response();\n\n  response.message = res.statusText;\n  response.code = res.status;\n  response.headers = res.headers;\n  response.data = res.data;\n  response.original = res;\n\n  return response;\n};\n\n/** axios适配 */\nexport function axiosAdapter(opt: AxiosOptions) {\n  return axios(opt.url, {\n    ...omit(opt, [\"body\", \"query\"]),\n    data: opt.body,\n    params: opt.query,\n  })\n    .then((res) => responseProcess(res))\n    .catch((err) => {\n      return Promise.reject(\n        new ResponseError(\n          `${err.name}: ${err.message}` || \"\",\n          err?.response ? responseProcess(err.response) : undefined\n        )\n      );\n    });\n}\n"],"names":["Response","ResponseError","axios","omit","responseProcess","res","response","message","statusText","code","status","headers","data","original","axiosAdapter","opt","url","body","params","query","then","catch","err","Promise","reject","name","undefined"],"mappings":"AAAA;;AACA,SAASA,QAAQ,QAAQ,aAAa,CAAC;AACvC,SAASC,aAAa,QAAQ,mBAAmB,CAAC;AAElD,OAAOC,KAAK,MAA8B,OAAO,CAAC;AAClD,SAASC,IAAI,QAAQ,YAAY,CAAC;AAMlC,IAAMC,eAAe,GAAG,SAACC,GAAQ,EAAK;IACpC,IAAMC,QAAQ,GAAG,IAAIN,QAAQ,EAAE,AAAC;IAEhCM,QAAQ,CAACC,OAAO,GAAGF,GAAG,CAACG,UAAU,CAAC;IAClCF,QAAQ,CAACG,IAAI,GAAGJ,GAAG,CAACK,MAAM,CAAC;IAC3BJ,QAAQ,CAACK,OAAO,GAAGN,GAAG,CAACM,OAAO,CAAC;IAC/BL,QAAQ,CAACM,IAAI,GAAGP,GAAG,CAACO,IAAI,CAAC;IACzBN,QAAQ,CAACO,QAAQ,GAAGR,GAAG,CAAC;IAExB,OAAOC,QAAQ,CAAC;AAClB,CAAC,AAAC;AAEF,YAAY,GACZ,OAAO,SAASQ,YAAY,CAACC,GAAiB,EAAE;IAC9C,OAAOb,KAAK,CAACa,GAAG,CAACC,GAAG,EAAE,wCACjBb,IAAI,CAACY,GAAG,EAAE;QAAC,MAAM;QAAE,OAAO;KAAC,CAAC;QAC/BH,IAAI,EAAEG,GAAG,CAACE,IAAI;QACdC,MAAM,EAAEH,GAAG,CAACI,KAAK;MAClB,CAAC,CACCC,IAAI,CAAC,SAACf,GAAG;eAAKD,eAAe,CAACC,GAAG,CAAC;KAAA,CAAC,CACnCgB,KAAK,CAAC,SAACC,GAAG,EAAK;QACd,OAAOC,OAAO,CAACC,MAAM,CACnB,IAAIvB,aAAa,CACf,AAAC,EAAA,CAAeqB,MAAW,CAAxBA,GAAG,CAACG,IAAI,EAAC,IAAE,CAAc,CAAA,MAAA,CAAZH,GAAG,CAACf,OAAO,CAAE,IAAI,EAAE,EACnCe,CAAAA,GAAG,aAAHA,GAAG,WAAU,GAAbA,KAAAA,CAAa,GAAbA,GAAG,CAAEhB,QAAQ,CAAA,GAAGF,eAAe,CAACkB,GAAG,CAAChB,QAAQ,CAAC,GAAGoB,SAAS,CAC1D,CACF,CAAC;IACJ,CAAC,CAAC,CAAC;AACP,CAAC"}