{"version":3,"sources":["/Users/lixianjie/project/openSource/m78/packages/request/src/plugin.ts","<<jsx-config-pragma.js>>"],"sourcesContent":["import { BaseRequestOptions, CreateOptions, Options } from \"./interfaces\";\nimport { ResponseError } from \"./response-error\";\nimport { Response } from \"./response\";\nimport { getNamePathValue } from \"@m78/utils\";\n\nexport class Plugin<Opt extends BaseRequestOptions = BaseRequestOptions> {\n  constructor(\n    public ctx: any, // 在不同插件间共享数据的对象, 插件应仅在自己命名空间下进行操作, 如缓存插件使用ctx.catch.xx\n    public createOptions: CreateOptions<Opt>, // 创建时配置\n    public options: Opt // request中传入的配置\n  ) {}\n\n  /**\n   * 帮助函数，从extraOption或createOption中取出指定名称的方法，前者优先级更高\n   * */\n  getCurrentOption<key extends keyof Options<Opt>>(\n    optionField: key\n  ): Options<Opt>[key] {\n    return (\n      getNamePathValue(this.options, [\"extraOption\", optionField]) ||\n      this.createOptions[optionField]\n    );\n  }\n\n  /**\n   * 请求开始之前执行, 如果返回了任意有效值, 会阻断后续所有操作并直接以`Promise<返回值>`作为request调用的响应\n   * */\n  before?(): any;\n\n  /**\n   * 转换请求结果并返回, 在转换过程中可以通过抛出错误来主动使该次请求'失败', 并进入catch阶段\n   * @param response - response是根据你配置的请求库类型返回决定的\n   * @return - 必须将经过处理后的response return，其他插件才能接受到经过处理后的response\n   * */\n  pipe?(response: Response): Response;\n\n  /**\n   * 请求成功, 对数据的处理请在pipe中执行，此函数只应用于进行消息反馈等\n   * */\n  success?(data: any, response: Response): void;\n\n  /** 请求失败 */\n  error?(error: ResponseError): void;\n\n  /** 请求结束 */\n  finish?(): void;\n}\n","React.createElement"],"names":["getNamePathValue","Plugin","ctx","createOptions","options","getCurrentOption","optionField"],"mappings":"AAAA;AAGA,SAASA,gBAAgB,QAAQ,YAAY,CAAC;AAE9C,OAAO,IAAA,AAAMC,MAAM,iBAAZ;;aAAMA,MAAM,CAERC,GAAQ,EACRC,aAAiC,EACjCC,OAAY,CAAC,gBAAgB;;gCAJ3BH,MAAM;QAERC,WAAAA,GAAQ,CAAA;QACRC,qBAAAA,aAAiC,CAAA;QACjCC,eAAAA,OAAY,CAAA;;iBAJVH,MAAM;IAOjB;;KAEG,GACHI,OAAAA,gBAAgB,AAOf,GAPDA,SAAAA,gBAAgB,CACdC,WAAgB,EACG;QACnB,OACEN,gBAAgB,CAAC,IAAI,CAACI,OAAO,EAAE;YAAC,aAAa;YAAEE,WAAW;SAAC,CAAC,IAC5D,IAAI,CAACH,aAAa,CAACG,WAAW,CAAC,CAC/B;IACJ,CAAC;WAjBUL,MAAM;CAyClB,EAAA,CAAA"}